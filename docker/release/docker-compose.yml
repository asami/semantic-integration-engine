version: "3.9"

services:
  # ---------------------------------------------------------
  # Apache Jena Fuseki — RDF triple store (SPARQL endpoint)
  # ---------------------------------------------------------
  fuseki:
    image: stain/jena-fuseki:4.7.0
    ports:
      - "9030:9030"
    environment:
      - FUSEKI_DATASET=ds
    volumes:
      - fuseki_data:/fuseki

  # ---------------------------------------------------------
  # ChromaDB — Vector database used for embedding retrieval
  # ---------------------------------------------------------
  chromadb:
    image: chromadb/chroma:latest
    ports:
      - "9040:9040"
    environment:
      - IS_PERSISTENT=1
      - ANONYMIZED_TELEMETRY=0
    volumes:
      - chroma_data:/chroma

  # ---------------------------------------------------------
  # SieServer (production / user distribution)
  # - Pulled from GHCR or Docker Hub
  # - Does NOT build from source
  # ---------------------------------------------------------
  sie:
    image: ghcr.io/asami/semantic-integration-engine:2025-11-21
    depends_on:
      - fuseki
      - chromadb
    ports:
      - "9050:9050"
    environment:
      FUSEKI_URL: http://fuseki:9030/ds
      CHROMA_URL: http://chromadb:9040
      SIESERVER_PORT: 9050

volumes:
  fuseki_data:
  chroma_data:
